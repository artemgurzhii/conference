var geolocator=function(){"use strict";function i(a,c,d){function f(a,b){d&&e.parentNode&&e.parentNode.removeChild(e),"function"==typeof a&&a(b)}var e=document.createElement("script");e.async=!0,e.readyState?e.onreadystatechange=function(a){("loaded"===e.readyState||"complete"===e.readyState)&&(e.onreadystatechange=null,f(c))}:e.onload=function(a){f(c)},e.onerror=function(c){var d="Could not load source at "+String(a).replace(/\?.*$/,"");f(b,new Error(d))},e.src=a,document.getElementsByTagName("head")[0].appendChild(e)}function j(a){function b(){geolocator.__glcb&&delete geolocator.__glcb,google.load("maps",e,{other_params:"",callback:a})}void 0!==window.google&&void 0!==google.maps?a&&a():void 0!==window.google&&void 0!==google.loader?b():(geolocator.__glcb=b,i(d+"?callback=geolocator.__glcb"))}function k(a,b,c){var d,e,f,g=document.getElementById(a);g?(d=new google.maps.Map(g,b),e=new google.maps.Marker({position:b.center,map:d}),f=new google.maps.InfoWindow,f.setContent(c),google.maps.event.addListener(e,"click",function(){f.open(d,e)}),geolocator.location.map={canvas:g,map:d,options:b,marker:e,infoWindow:f}):geolocator.location.map=null}function l(a,b){function d(a,c){c===google.maps.GeocoderStatus.OK&&b&&b(a)}var c=new google.maps.Geocoder;c.geocode({latLng:a},d)}function m(a){if(a&&a.length>0){var b,c,d={},e=a[0].address_components;for(b=0;b<e.length;b+=1)c=e[b],c.types&&c.types.length>0&&(d[c.types[0]]=c.long_name,d[c.types[0]+"_s"]=c.short_name);geolocator.location.formattedAddress=a[0].formatted_address,geolocator.location.address={street:d.route||"",neighborhood:d.neighborhood||"",town:d.sublocality||"",city:d.locality||"",region:d.administrative_area_level_1||"",country:d.country||"",countryCode:d.country_s||"",postalCode:d.postal_code||"",streetNumber:d.street_number||""}}}function n(b){function e(b){m(b);var e=null===geolocator.location.ipGeoSource?14:7,f={zoom:e,center:d,mapTypeId:"roadmap"};k(c,f,b[0].formatted_address),a&&a.call(null,geolocator.location)}var d=new google.maps.LatLng(b.latitude,b.longitude);l(d,e)}function o(d,e){function f(e){var f=d===!0?0:"number"==typeof d?d:-1;f>=0?geolocator.locateByIP(a,b,f,c):b&&b(e)}function g(a){geolocator.location={ipGeoSource:null,coords:a.coords,timestamp:(new Date).getTime()},n(geolocator.location.coords)}function h(a){f(a)}geolocator.location=null,navigator.geolocation?navigator.geolocation.getCurrentPosition(g,h,e):f(new Error("geolocation is not supported."))}function p(a,b){switch(a){case 0:geolocator.location={coords:{latitude:b.latitude,longitude:b.longitude},address:{city:b.city,country:b.country_name,countryCode:b.country_code,region:b.region_name}};break;case 1:geolocator.location={coords:{latitude:b.geoplugin_latitude,longitude:b.geoplugin_longitude},address:{city:b.geoplugin_city,country:b.geoplugin_countryName,countryCode:b.geoplugin_countryCode,region:b.geoplugin_regionName}};break;case 2:geolocator.location={coords:{latitude:b.lat,longitude:b.lon},address:{city:b.city,country:"",countryCode:b.country,region:""}}}geolocator.location&&(geolocator.location.coords.accuracy=null,geolocator.location.coords.altitude=null,geolocator.location.coords.altitudeAccuracy=null,geolocator.location.coords.heading=null,geolocator.location.coords.speed=null,geolocator.location.timestamp=(new Date).getTime(),geolocator.location.ipGeoSource=f[a],geolocator.location.ipGeoSource.data=b)}function q(a){function d(){2===h?void 0!==window.Geo&&(p(h,window.Geo),delete window.Geo,c=!0):void 0!==a&&"string"!=typeof a&&(p(h,a),c=!0),c===!0?n(geolocator.location.coords):b&&b(new Error(a||"Could not get location."))}var c=!1;geolocator.location=null,delete geolocator.__ipscb,j(d)}function r(a){void 0===a.cbParam||null===a.cbParam||""===a.cbParam?i(a.url,q,!0):i(a.url+"?"+a.cbParam+"=geolocator.__ipscb",void 0,!0)}var a,b,c,h,d="https://www.google.com/jsapi",e="3.18",f=[{url:"//freegeoip.net/json/",cbParam:"callback"},{url:"//www.geoplugin.net/json.gp",cbParam:"jsoncallback"},{url:"//geoiplookup.wikimedia.org/",cbParam:""}],g=1;return{location:null,locate:function(d,e,f,g,h){function i(){o(f,g)}a=d,b=e,c=h,j(i)},locateByIP:function(d,e,i,j){h="number"!=typeof i||0>i||i>=f.length?g:i,a=d,b=e,c=j,geolocator.__ipscb=q,r(f[h])},isPositionError:function(a){return"[object PositionError]"===Object.prototype.toString.call(a)}}}();
